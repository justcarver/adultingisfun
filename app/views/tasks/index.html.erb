<h1>Listing Tasks</h1>

<table class="table table-condensed">
  <thead>
    <tr>
      <th>Title</th>
      <th>Description</th>
      <th>Points</th>
      <th>Expiration</th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @tasks.each do |task| %>
      <% if task.current? %>
	<tr>
	  <td><%= task.title %></td>
	  <td><%= task.description %></td>
	  <td><%= task.points %></td>
	  <td><%= task.expiration %></td>
	  <td>
	    <% if user_signed_in? && current_user.achievements.where(task_id: task.id) == [] %>
	      <%= 
		button_to 'Claim Acehievement',
			{ :method => :post,
			  :controller => "achievement",
			  :action => "create",
			  :achievement => { user_id: current_user.id,
					  task_id: task.id,
					  points: task.points }
			},
		 	{ class: 'btn btn-success' }
	      %>
	    <% end %>
	  </td>
	</tr>
      <% end %>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Task', new_task_path %>
